"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _compose=require("@wordpress/compose"),_refractCallbag=require("refract-callbag"),_callbagBasics=require("callbag-basics"),_callbagOf=_interopRequireDefault(require("callbag-of"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,r){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],t=!0,l=!1,i=void 0;try{for(var n,o=e[Symbol.iterator]();!(t=(n=o.next()).done)&&(a.push(n.value),!r||a.length!==r);t=!0);}catch(e){l=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(l)throw i}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function MediaLibrary(e){return(0,e.children)({openMediaBrowser:e.openMediaBrowser})}function aperture(e){var r=e.mount,a=e.unmount,t=_slicedToArray(e.useEvent("openMediaBrowserEvent"),2),l=t[0],i=t[1];return(0,_callbagBasics.merge)((0,_callbagBasics.pipe)(r,(0,_callbagBasics.map)(function(){return{type:"INIT"}})),(0,_callbagBasics.pipe)(a,(0,_callbagBasics.map)(function(){return{type:"DESTROY"}})),(0,_callbagBasics.pipe)((0,_callbagOf.default)({openMediaBrowser:i}),(0,_callbagBasics.map)(_refractCallbag.toProps)),(0,_callbagBasics.pipe)(l,(0,_callbagBasics.map)(function(e){return{type:"OPEN",payload:e}})))}function handler(t){var l=null;return function(e){switch(e.type){case"INIT":var r=t.onSelect,a=t.typeFilter;(l=wp.media({title:t.title,library:{type:a},button:{text:t.buttonLabel},multiple:t.multiple})).on("select",function(){var e=l.state().get("selection").toJSON();r(e)});break;case"OPEN":l&&l.open();break;case"DESTROY":l=null}}}var applyWithEffects=(0,_refractCallbag.withEffects)(aperture,{handler:handler}),_default=(0,_compose.compose)(applyWithEffects)(MediaLibrary);exports.default=_default;