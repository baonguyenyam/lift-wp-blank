"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(n){var r={};function o(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=n,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==_typeof(t)&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=64)}([function(e,t){e.exports=lodash},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){e.exports=wp.i18n},function(e,t){e.exports=wp.hooks},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=wp.data},function(e,t){e.exports=cf.core},function(e,t){e.exports=wp.element},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},function(e,t,n){var r=n(46),o=n(1);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?o(e):t}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}t.exports=n},function(e,t,n){var r=n(47);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t){e.exports=wp.components},function(e,t,n){var o=n(4);e.exports=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(e){o(t,e,n[e])})}return t}},function(e,t){e.exports=wp.editor},function(e,t){e.exports=wp.blocks},function(e,t){e.exports=cf.vendor.immer},function(e,t,n){e.exports={forEach:n(25),fromObs:n(26),fromIter:n(27),fromEvent:n(28),fromPromise:n(29),interval:n(30),map:n(31),scan:n(32),flatten:n(33),take:n(34),skip:n(35),filter:n(36),merge:n(37),concat:n(38),combine:n(39),share:n(40),pipe:n(41)}},function(e,t){e.exports=wp.compose},function(e,t,n){var r=n(43),o=n(44),i=n(45);e.exports=function(e){return r(e)||o(e)||i()}},function(e,t){e.exports=wp.date},function(e,t,n){var r,c;function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var r=_typeof(n);if("string"===r||"number"===r)e.push(n);else if(Array.isArray(n)&&n.length){var o=a.apply(null,n);o&&e.push(o)}else if("object"===r)for(var i in n)c.call(n,i)&&n[i]&&e.push(i)}}return e.join(" ")}c={}.hasOwnProperty,e.exports?(a.default=a,e.exports=a):void 0===(r=function(){return a}.apply(t,[]))||(e.exports=r)},function(e,t){e.exports=wp.apiFetch},function(e,t){e.exports=function(r){return function(e){var n;e(0,function(e,t){0===e&&(n=t),1===e&&r(t),1!==e&&0!==e||n(1)})}}},function(e,t){e.exports=function(r){return function(e,t){var n;0===e&&(t(0,function(e){2===e&&n&&(n.unsubscribe?n.unsubscribe():n())}),n=r.subscribe({next:function(e){return t(1,e)},error:function(e){return t(2,e)},complete:function(){return t(2)}}))}}},function(e,t){e.exports=function(c){return function(e,t){var n,r,o,i;0===e&&(n="undefined"!=typeof Symbol&&c[Symbol.iterator]?c[Symbol.iterator]():c,i=o=!1,t(0,function(e){1===e&&(i=!0,o||r&&r.done||function(){for(o=!0;i;)i=!1,(r=n.next()).done?t(2):t(1,r.value);o=!1}())}))}}},function(e,t){e.exports=function(r,o){return function(e,t){var n;0===e&&(n=function(e){return t(1,e)},t(0,function(e){2===e&&r.removeEventListener(o,n)}),r.addEventListener(o,n))}}},function(e,t){e.exports=function(r){return function(e,t){var n;0===e&&(n=!1,r.then(function(e){n||(t(1,e),t(2))},function(e){n||t(2,e)}),t(0,function(e){2===e&&(n=!0)}))}}},function(e,t){e.exports=function(o){return function(e,t){var n,r;0===e&&(n=0,r=setInterval(function(){t(1,n++)},o),t(0,function(e){2===e&&clearInterval(r)}))}}},function(e,t){e.exports=function(r){return function(t){return function(e,n){0===e&&t(0,function(e,t){n(e,1===e?r(t):t)})}}}},function(e,t){e.exports=function(o,i){var c=2===arguments.length;return function(t){return function(e,n){var r;0===e&&(r=i,t(0,function(e,t){1===e?(r=c?o(r,t):(c=!0,t),n(1,r)):n(e,t)}))}}}},function(e,t){e.exports=function(t){return function(e,r){var o,i,c,a,l;function u(e){1===e&&(a||c||function(){})(1),2===e&&(a&&a(2),c&&c(2))}0===e&&(o=function(e){return void 0!==e},i=function(e){return void 0===e},l=!function(){},t(0,function(e,t){var n;0===e?(c=t,r(0,u)):1===e?(n=t,a&&a(2),n(0,function(e,t){0===e?(a=t)(1):1===e?r(1,t):2===e&&i(t)?l?r(2):(a=void 0,c(1)):2===e&&o(t)&&r(2,t)})):2===e&&i(t)?a?l=!0:r(2):2===e&&o(t)&&r(2,t)}))}}},function(e,t){e.exports=function(c){return function(t){return function(e,n){var r,o;function i(e,t){o<c&&r(e,t)}0===e&&t(o=0,function(e,t){0===e?(r=t,n(0,i)):1===e?o<c&&(o++,n(e,t),o===c&&(n(2),r(2))):n(e,t)})}}}},function(e,t){e.exports=function(i){return function(t){return function(e,n){var r,o;0===e&&t(o=0,function(e,t){0===e?n(e,r=t):1===e&&o<i?(o++,r(1)):n(e,t)})}}}},function(e,t){e.exports=function(o){return function(t){return function(e,n){var r;0===e&&t(0,function(e,t){0===e?n(e,r=t):1!==e||o(t)?n(e,t):r(1)})}}}},function(e,t){e.exports=function(){for(var e=arguments.length,u=new Array(e),t=0;t<e;t++)u[t]=arguments[t];return function(e,r){if(0===e)for(var o=u.length,i=new Array(o),c=0,a=0,l=function(e){if(0!==e)for(var t=0;t<o;t++)i[t]&&i[t](e)},t=0;t<o;t++)!function(n){u[n](0,function(e,t){0===e?(i[n]=t,1==++c&&r(0,l)):2===e?(i[n]=void 0,++a===o&&r(2)):r(e,t)})}(t)}}},function(e,t){e.exports=function(){for(var e=arguments.length,a=new Array(e),t=0;t<e;t++)a[t]=arguments[t];return function(e,r){if(0===e){var t=a.length;if(0===t)return r(0,function(){}),void r(2);var o,i=0,c=function(e,t){1!==e&&2!==e||o(e,t)};!function n(){i!==t?a[i](0,function(e,t){0===e?(o=t,0===i?r(0,c):o(1)):1===e?r(1,t):2===e&&(i++,n())}):r(2)}()}}}},function(e,t){var b={};e.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,c){if(0===e){var a=t.length;if(0===a)return c(0,function(){}),c(1,[]),void c(2);var l=a,u=a,s=a,f=new Array(a),p=new Array(a),d=function(e){if(2===e)for(var t=0;t<a;t++)p[t](2)};t.forEach(function(e,i){f[i]=b,e(0,function(e,t){if(0===e)p[i]=t,0==--l&&c(0,d);else if(1===e){var n=u?f[i]===b?--u:u:0;if(f[i]=t,0===n){for(var r=new Array(a),o=0;o<a;++o)r[o]=f[o];c(1,r)}}else 2===e?0==--s&&c(2):c(e,t)})})}}}},function(e,t){e.exports=function(t){var u,s=[];return function(e,a){var l;0===e&&(s.push(a),l=function(e,t){var n;0!==e&&(2===e?(-1<(n=s.indexOf(a))&&s.splice(n,1),s.length||u(2)):u(e,t))},1!==s.length?a(0,l):t(0,function(e,t){if(0===e)u=t,a(0,l);else{var n=!0,r=!1,o=void 0;try{for(var i,c=s.slice(0)[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){(0,i.value)(e,t)}}catch(e){r=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw o}}}2===e&&(s=[])}))}}},function(e,t){e.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=t[0],o=1,i=t.length;o<i;o++)r=t[o](r);return r}},function(e,t,n){},function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(t,e){function n(e){return(n="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)})(e)}function r(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=r=function(e){return n(e)}:t.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},r(e)}t.exports=r},function(n,e){function r(e,t){return n.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}n.exports=r},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){n.r(t);var r={};n.r(r),n.d(r,"setupContainerDefinitions",function(){return Q}),n.d(r,"setupFieldDefinitions",function(){return X});var o={};n.r(o),n.d(o,"getContainerDefinitionByBlockName",function(){return Y}),n.d(o,"getFieldDefinitionsByBlockName",function(){return Z});function i(e,t){return e===t}var c=n(15),a=n.n(c),u=n(5),l=n(17),s=n(2),p=n(0),f=n(20),d=n(3),b=n(6),m=n(19);function h(e,t){var n=1<arguments.length&&void 0!==t?t:0;return Object(p.mapKeys)(e,function(e,t){return"".concat(Object(p.repeat)("parent.",n)).concat(t)})}function v(e){return Object(p.startsWith)(e,"cf-")}var y=Object(b.withConditionalLogic)(function(e){return Object(m.pipe)(Object(b.fromSelector)(Object(u.select)("core/editor").getBlock,e.blockId),(void 0===c&&(c=i),function(t){return function(e,n){var r,o,i;0===e&&(i=!1,t(0,function(e,t){0===e&&(o=t),1===e?i&&c(r,t)?o(1):(i=!0,n(1,r=t)):n(e,t)}))}}),Object(m.map)(function(e){return e.attributes.data}));var c},function(e,t){var n={};if(Object(p.has)(t,e.field.base_name))n=h(Object(p.omit)(t,[e.field.base_name]));else{var r=e.id.split("__");r.shift();var o=r.shift();r.pop();for(var i=r.reduce(function(e,t){return v(t)?e:e+1},0),n=h(n=Object(p.omit)(t,[o]),i+1),c=o;0<r.length;){var a,l,u=r.shift(),s=v(u),f=!s;s&&(a=Object(p.findIndex)(Object(p.get)(t,c),["_id",u]),c="".concat(c,".").concat(a),l=Object(p.get)(t,c),l=h(l=Object(p.omit)(l,["_id","_type",e.field.base_name]),i),Object(p.assign)(n,l)),f&&(c="".concat(c,".").concat(u),i--)}}return n});n(42),Object(d.addFilter)("carbon-fields.association.block","carbon-fields/blocks",Object(b.withProps)(function(l){return{hierarchyResolver:function(){var e=Object(u.select)("core/editor").getBlock(l.blockId),t=l.id.split("__");t.shift();for(var n=t.shift(),r="data.".concat(n);0<t.length;){var o,i,c,a=t.shift();n=0===a.indexOf("cf-")?(o=Object(p.get)(e.attributes,"".concat(r)),i=Object(p.find)(o,["_id",a]),c=o.indexOf(i),r="".concat(r,".").concat(c),"".concat(n,"[").concat(c,"]:").concat(i._type,"/")):(r="".concat(r,".").concat(a),"".concat(n).concat(a))}return n}}}));var g,_=n(21),O=n.n(_),k=n(8),j=n.n(k),w=n(9),S=n.n(w),x=n(10),E=n.n(x),I=n(11),F=n.n(I),C=n(12),G=n.n(C),T=n(1),A=n.n(T),N=n(4),B=n.n(N),P=n(18),D=n.n(P),M=n(7),L=(n(48),n(49),Object(b.withFilters)("carbon-fields.field-wrapper.block")(b.Field)),R=(g=M.Component,G()(U,g),S()(U,[{key:"getGroupValues",value:function(){return this.props.value.map(function(e){var t=Object(p.mapKeys)(Object(p.omit)(e,["_id","_type"]),function(e,t){return t.replace(/\-/g,"_")});return[e._type,t]})}},{key:"render",value:function(){var e=this.handleGroupSetup,t=this.handleGroupFieldSetup,n=this.handleAddGroup,r=this.handleCloneGroup,o=this.handleRemoveGroup,i=this.handleToggleGroup,c=this.handleToggleAllGroups,a=this.props,l=a.value;return(0,a.children)({groupValues:this.getGroupValues(),allGroupsAreCollapsed:this.state.collapsedGroups.length===l.length,handleGroupSetup:e,handleGroupFieldSetup:t,handleAddGroup:n,handleCloneGroup:r,handleRemoveGroup:o,handleToggleGroup:i,handleToggleAllGroups:c})}}]),U);function U(){var e,l;j()(this,U);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return l=E()(this,(e=F()(U)).call.apply(e,[this].concat(n))),B()(A()(A()(l)),"state",{collapsedGroups:l.props.value.reduce(function(e,t){var n=t._id,r=t._type;return Object(p.find)(l.props.field.groups,["name",r]).collapsed?e.concat(n):e},[])}),B()(A()(A()(l)),"handleAddGroup",function(e,t){var n=l.props,r=n.id,o=n.value,i=n.onChange,c={};c._id=Object(b.uniqueId)(),c._type=e.name,e.fields.reduce(function(e,t){return e[t.base_name]=t.default_value,e},c),i(r,o.concat(c)),t(c)}),B()(A()(A()(l)),"handleCloneGroup",function(e,t){var n=l.props,r=n.id,o=n.value,i=n.onChange,c=o.indexOf(e),a=Object(p.cloneDeep)(e);a._id=Object(b.uniqueId)(),i(r,D()(o,function(e){e.splice(c+1,0,a)})),t(a)}),B()(A()(A()(l)),"handleRemoveGroup",function(n){var e=l.props,t=e.id,r=e.value,o=e.onChange,i=Object(p.findIndex)(r,["_id",n._id]);o(t,D()(r,function(e){e.splice(i,1)})),l.setState(function(e){var t=e.collapsedGroups;return{collapsedGroups:Object(p.without)(t,n._id)}})}),B()(A()(A()(l)),"handleToggleGroup",function(n){l.setState(function(e){var t=e.collapsedGroups;return{collapsedGroups:t=-1<t.indexOf(n)?Object(p.without)(t,n):O()(t).concat([n])}})}),B()(A()(A()(l)),"handleToggleAllGroups",function(){var t=l.props.value;l.setState(function(e){return{collapsedGroups:e.collapsedGroups.length!==t.length?t.map(function(e){return e._id}):[]}})}),B()(A()(A()(l)),"handleGroupSetup",function(e,t){var n=Object(p.get)(Object(p.find)(l.props.field.groups,["name",e._type]),"fields",[]),r=Object(p.omit)(e,["_id","_type"]);return Object(p.assign)({},t,{id:e._id,fields:n,collapsed:-1<l.state.collapsedGroups.indexOf(e._id),context:"block",values:r})}),B()(A()(A()(l)),"handleGroupFieldSetup",function(e,t,n){var r=l.props.blockId,o="".concat(l.props.id,"__").concat(n.id,"__").concat(e.base_name),i=Object(p.get)(n,"values.".concat(e.base_name));return[L,Object(p.assign)({},t,{key:o,id:o,name:e.base_name,containerId:l.props.containerId,blockId:r,field:e,value:i,onChange:l.handleGroupFieldChange})]}),B()(A()(A()(l)),"handleGroupFieldChange",function(o,i){var e=l.props,t=e.id,n=e.value;(0,e.onChange)(t,D()(n,function(e){var t=o.split("__"),n=t.pop(),r=Object(p.find)(e,["_id",t.pop()]);Object(p.set)(r,n,i)}))}),l}Object(d.addFilter)("carbon-fields.complex.block","carbon-fields/blocks",function(h){return function(s){var f=s.id,p=s.name,d=s.value,b=s.error,m=s.field;return wp.element.createElement(R,s,function(e){var t=e.groupValues,n=e.allGroupsAreCollapsed,r=e.handleGroupSetup,o=e.handleGroupFieldSetup,i=e.handleAddGroup,c=e.handleCloneGroup,a=e.handleRemoveGroup,l=e.handleToggleGroup,u=e.handleToggleAllGroups;return wp.element.createElement(h,{groupIdKey:"_id",groupFilterKey:"_type",id:f,name:p,value:d,error:b,field:m,groupValues:t,allGroupsAreCollapsed:n,onGroupSetup:r,onGroupFieldSetup:o,onAddGroup:i,onCloneGroup:c,onRemoveGroup:a,onToggleGroup:l,onToggleAllGroups:u,onChange:s.onChange})})}});var q,V=n(13),K=n.n(V),W=n(22),$=(n(50),q=M.Component,G()(H,q),S()(H,[{key:"render",value:function(){var e=this.handleChange;return(0,this.props.children)({handleChange:e})}}]),H);function H(){var e,l;j()(this,H);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return l=E()(this,(e=F()(H)).call.apply(e,[this].concat(n))),B()(A()(A()(l)),"handleChange",function(e,t){var n=l.props,r=n.id,o=n.onChange,i=n.value,c=n.field,a=Object(W.format)(c.storage_format,t);a!==i&&o(r,a)}),l}Object(d.addFilter)("carbon-fields.date_time.block","carbon-fields/blocks",function(r){return function(n){return wp.element.createElement($,n,function(e){var t=e.handleChange;return wp.element.createElement(r,K()({buttonText:Object(s.__)("Select Date","carbon-fields-ui")},n,{onChange:t}))})}}),Object(d.addFilter)("carbon-fields.date.block","carbon-fields/blocks",function(r){return function(n){return wp.element.createElement($,n,function(e){var t=e.handleChange;return wp.element.createElement(r,K()({},n,{onChange:t}))})}}),Object(d.addFilter)("carbon-fields.time.block","carbon-fields/blocks",function(r){return function(n){return wp.element.createElement($,n,function(e){var t=e.handleChange;return wp.element.createElement(r,K()({},n,{onChange:t}))})}}),n(51),Object(d.addFilter)("carbon-fields.file.block","carbon-fields/blocks",function(t){return function(e){return wp.element.createElement(t,K()({buttonLabel:Object(s.__)("Select File","carbon-fields-ui"),mediaLibraryButtonLabel:Object(s.__)("Use File","carbon-fields-ui"),mediaLibraryTitle:Object(s.__)("Select File","carbon-fields-ui")},e))}});function z(e){var t=e.type;return wp.element.createElement("em",null,Object(s.sprintf)(Object(s.__)("Field of type '%s' is not supported in Gutenberg.","carbon-fields-ui"),[t]))}Object(d.addFilter)("carbon-fields.footer_scripts.block","carbon-fields/blocks",function(){return function(e){return wp.element.createElement(z,{type:e.field.type})}}),Object(d.addFilter)("carbon-fields.header_scripts.block","carbon-fields/blocks",function(){return function(e){return wp.element.createElement(z,{type:e.field.type})}}),Object(d.addFilter)("carbon-fields.hidden.block","carbon-fields/blocks",function(){return function(e){return wp.element.createElement(z,{type:e.field.type})}}),Object(d.addFilter)("carbon-fields.image.block","carbon-fields/blocks",function(t){return function(e){return wp.element.createElement(t,K()({buttonLabel:Object(s.__)("Select Image","carbon-fields-ui"),mediaLibraryButtonLabel:Object(s.__)("Use Image","carbon-fields-ui"),mediaLibraryTitle:Object(s.__)("Select Image","carbon-fields-ui")},e))}}),n(52),n(53),n(54),Object(d.addFilter)("carbon-fields.media_gallery.block","carbon-fields/blocks",function(t){return function(e){return wp.element.createElement(t,K()({buttonLabel:Object(s.__)("Select Attachments","carbon-fields-ui"),mediaLibraryButtonLabel:Object(s.__)("Use Attachments","carbon-fields-ui"),mediaLibraryTitle:Object(s.__)("Select Attachments","carbon-fields-ui")},e))}}),n(55),n(56),n(57),n(58),n(59),Object(d.addFilter)("carbon-fields.sidebar.block","carbon-fields/blocks",function(){return function(e){return wp.element.createElement(z,{type:e.field.type})}}),n(60),n(61),n(62),Object(d.addFilter)("carbon-fields.field-edit.block","carbon-fields/blocks",Object(f.compose)(y,Object(u.withDispatch)(function(e){var t=e("core/editor");return{lockSaving:t.lockPostSaving,unlockSaving:t.unlockPostSaving}}),b.withValidation));var J=Object(u.combineReducers)({containerDefinitionsByBlockName:function(e,t){var n=0<arguments.length&&void 0!==e?e:{},r=1<arguments.length?t:void 0;switch(r.type){case"SETUP_CONTAINER_DEFINITIONS":return r.payload.definitions;default:return n}},fieldDefinitionsByBlockName:function(e,t){var n=0<arguments.length&&void 0!==e?e:{},r=1<arguments.length?t:void 0;switch(r.type){case"SETUP_FIELD_DEFINITIONS":return r.payload.definitions;default:return n}}});function Q(e){return{type:"SETUP_CONTAINER_DEFINITIONS",payload:{definitions:e}}}function X(e){return{type:"SETUP_FIELD_DEFINITIONS",payload:{definitions:e}}}function Y(e,t){return e.containerDefinitionsByBlockName[t.replace("carbon-fields/","")]||{}}function Z(e,t){return e.fieldDefinitionsByBlockName[t.replace("carbon-fields/","")]||[]}Object(u.registerStore)("carbon-fields/blocks",{reducer:J,actions:r,selectors:o});var ee,te,ne,re=n(23),oe=n.n(re),ie=n(14),ce=n(16),ae=(n(63),n(24)),le=n.n(ae),ue=(ne=M.Component,G()(he,ne),S()(he,[{key:"componentDidMount",value:function(){this.isStillMounted=!0,this.fetch(this.props),this.fetch=Object(p.debounce)(this.fetch,500)}},{key:"componentWillUnmount",value:function(){this.isStillMounted=!1}},{key:"componentDidUpdate",value:function(e){Object(p.isEqual)(e,this.props)||this.fetch(this.props)}},{key:"fetch",value:function(e){var t,n,r=this;this.isStillMounted&&(null!==this.state.response&&this.setState({response:null}),t=e.block,n=this.currentFetchRequest=le()({method:"post",path:"/carbon-fields/v1/block-renderer",data:{name:t.name,content:Object(l.serialize)([t])}}).then(function(e){r.isStillMounted&&n===r.currentFetchRequest&&e&&e.rendered&&r.setState({response:e.rendered})}).catch(function(e){r.isStillMounted&&n===r.currentFetchRequest&&r.setState({response:{error:!0,errorMsg:e.message}})}))}},{key:"render",value:function(){var e=this.state.response,t=this.props.className;return e?e.error?wp.element.createElement(ie.Placeholder,{className:t},Object(s.sprintf)(Object(s.__)("Error loading block: %s","carbon-fields-ui"),e.errorMsg)):e.length?wp.element.createElement(M.RawHTML,{key:"html",className:t},e):wp.element.createElement(ie.Placeholder,{className:t},Object(s.__)("No results found.","carbon-fields-ui")):wp.element.createElement(ie.Placeholder,{className:t},wp.element.createElement(ie.Spinner,null))}}]),he),se=Object(u.withSelect)(function(e,t){var n=t.clientId;return{block:(0,e("core/editor").getBlock)(n)}})(ue),fe=(te=M.Component,G()(me,te),S()(me,[{key:"renderTabbedFields",value:function(e){var r=this,o=this.props.fields;return Object(p.map)(e,function(e,t){var n=Object(p.find)(o,["name",e]);return r.renderField(n,t)})}},{key:"renderNonTabbedFields",value:function(){return wp.element.createElement("div",{className:"cf-block__fields"},this.props.fields.map(this.renderField))}},{key:"render",value:function(){var r=this,o=this.state.currentTab,e=this.props,t=e.clientId,n=e.container,i=e.supportsTabs,c=e.supportsPreview,a=e.supportsInnerBlocks&&this.isInEditMode&&wp.element.createElement("div",{className:"cf-block__inner-blocks"},wp.element.createElement(ce.InnerBlocks,{template:n.settings.inner_blocks.template,templateLock:n.settings.inner_blocks.template_lock,allowedBlocks:n.settings.inner_blocks.allowed_blocks}));return wp.element.createElement(M.Fragment,null,"above"===n.settings.inner_blocks.position&&a,c&&wp.element.createElement(ce.BlockControls,null,wp.element.createElement(ie.Toolbar,{controls:[{icon:this.isInEditMode?"visibility":"hidden",title:this.isInEditMode?Object(s.__)("Show preview","carbon-fields-ui"):Object(s.__)("Hide preview","carbon-fields-ui"),onClick:this.handleModeChange}]})),this.isInEditMode&&i&&wp.element.createElement("div",{className:"cf-block__tabs"},wp.element.createElement("ul",{className:"cf-block__tabs-list"},Object(p.map)(n.settings.tabs,function(e,t){var n=oe()("cf-block__tabs-item",{"cf-block__tabs-item--current":t===o});return wp.element.createElement("li",{key:t,className:n,onClick:function(){return r.handleTabChange(t)}},t)}))),this.isInEditMode&&(i?Object(p.map)(n.settings.tabs,function(e,t){return wp.element.createElement("div",{className:"cf-block__fields",key:t,hidden:t!==o},r.renderTabbedFields(e))}):this.renderNonTabbedFields()),this.isInPreviewMode&&wp.element.createElement("div",{className:"cf-block__preview"},wp.element.createElement(se,{clientId:t})),"below"===n.settings.inner_blocks.position&&a,this.isInPreviewMode&&wp.element.createElement(ce.InspectorControls,null,i?Object(p.map)(n.settings.tabs,function(e,t){return wp.element.createElement(ie.PanelBody,{key:t,title:t},wp.element.createElement("div",{className:"cf-block__fields"},r.renderTabbedFields(e)))}):wp.element.createElement(ie.PanelBody,{title:Object(s.__)("Fields","carbon-fields-ui")},this.renderNonTabbedFields())))}},{key:"isInEditMode",get:function(){return"edit"===this.state.mode}},{key:"isInPreviewMode",get:function(){return"preview"===this.state.mode}}]),me),pe=Object(u.withSelect)(function(e,t){var n=t.clientId,r=t.name,o=e("core/blocks").hasBlockSupport,i=e("core/editor").getBlockRootClientId,c=e("carbon-fields/blocks"),a=c.getContainerDefinitionByBlockName,l=c.getFieldDefinitionsByBlockName,u=i(n);return{container:a(r),fields:l(r),supportsTabs:o(r,"tabs"),supportsPreview:o(r,"preview")&&!u,supportsInnerBlocks:o(r,"innerBlocks")}})(fe),de=(ee=M.Component,G()(be,ee),S()(be,[{key:"render",value:function(){return null}}]),be);function be(){return j()(this,be),E()(this,F()(be).apply(this,arguments))}function me(){var e,u;j()(this,me);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return u=E()(this,(e=F()(me)).call.apply(e,[this].concat(n))),B()(A()(A()(u)),"state",{mode:u.props.container.settings.mode,currentTab:u.props.supportsTabs?Object.keys(u.props.container.settings.tabs)[0]:null}),B()(A()(A()(u)),"handleFieldChange",function(e,t){var n=u.props,r=n.attributes,o=n.setAttributes,i=e.replace(/^.+__(.+)?$/,"$1");o({data:a()({},r.data,B()({},i,t))})}),B()(A()(A()(u)),"handleModeChange",function(){u.setState({mode:u.isInEditMode?"preview":"edit"})}),B()(A()(A()(u)),"handleTabChange",function(e){u.setState({currentTab:e})}),B()(A()(A()(u)),"renderField",function(e,t){var n=u.props,r=n.clientId,o=n.container,i=n.attributes,c=Object(b.getFieldType)(e.type,"block");if(!c)return null;var a="cf-".concat(r,"__").concat(e.base_name),l=Object(p.get)(i.data,e.base_name,e.default_value);return wp.element.createElement(L,{key:t,id:a,field:e},wp.element.createElement(c,{id:a,containerId:o.id,blockId:r,value:l,field:e,name:e.base_name,onChange:u.handleFieldChange}))}),u}function he(){var e,t;j()(this,he);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=E()(this,(e=F()(he)).call.apply(e,[this].concat(r))),B()(A()(A()(t)),"state",{response:null}),t}wp.hooks.addFilter("blocks.getSaveElement","carbon-fields/blocks",function(e,t){return/^carbon\-fields\/.+$/.test(t.name)&&t.supports.innerBlocks?wp.element.createElement(ce.InnerBlocks.Content,null):e});var ve=de;Object(s.setLocaleData)(window.cf.config.locale,"carbon-fields-ui");var ye={},ge={};Object(p.get)(window.cf,"preloaded.blocks",[]).forEach(function(r){function e(e,t){var n=1<arguments.length&&void 0!==t?t:null;return Object(p.get)(r,"settings.".concat(e),n)}var t=Object(p.kebabCase)(r.id).replace("carbon-fields-container-",""),n=r.fields.reduce(function(e,t){return a()({},e,B()({},t.base_name,t.default_value))},{});ye[t]=r,ge[t]=r.fields.map(function(e){return a()({},e)}),Object(l.registerBlockType)("carbon-fields/".concat(t),{title:r.title,icon:e("icon"),parent:e("parent",[]),category:e("category.slug"),keywords:e("keywords",[]),description:e("description",""),attributes:{data:{type:"object",default:n}},supports:{tabs:Object(p.isPlainObject)(e("tabs")),preview:e("preview"),innerBlocks:e("inner_blocks.enabled"),alignWide:!1,anchor:!1,html:!1},edit:pe,save:ve})}),Object(u.dispatch)("carbon-fields/blocks").setupContainerDefinitions(ye),Object(u.dispatch)("carbon-fields/blocks").setupFieldDefinitions(ge)}]);