"use strict";!function(l){window.InlineShortcodeView_vc_tta_tabs=window.InlineShortcodeView_vc_tta_accordion.extend({render:function(){return window.InlineShortcodeView_vc_tta_tabs.__super__.render.call(this),_.bindAll(this,"buildSortableNavigation","updateSortingNavigation"),this.createTabs(),_.defer(this.buildSortableNavigation),this},createTabs:function(){var t=_.sortBy(vc.shortcodes.where({parent_id:this.model.get("id")}),function(t){return t.get("order")});_.each(t,function(t){this.sectionUpdated(t,!0)},this)},defaultSectionTitle:window.i18nLocale.tab,addIcon:function(t,a){var e,i;return"true"===t.getParam("add_icon")&&(e=t.getParam("i_icon_"+t.getParam("i_type")),_.isUndefined(e)||(i='<i class="'+("vc_tta-icon "+e)+'"></i>'),"right"===t.getParam("i_position")?a+=i:a=i+a),a},sectionUpdated:function(t,a){var e,i,n,d=!1,s=t.get("id"),o=this.$el.find(".vc_tta-tabs-container .vc_tta-tabs-list"),r=o.find('[data-vc-target="[data-model-id='+s+']"]'),c=t.getParam("title");r.length?(n='<span class="vc_tta-title-text">'+c+"</span>",n=this.addIcon(t,n),r.html(n)):(n='<span class="vc_tta-title-text">'+c+"</span>",n=this.addIcon(t,n),i=l('<li class="vc_tta-tab" data-vc-target-model-id="'+s+'" data-vc-tab><a href="javascript:;" data-vc-use-cache="false" data-vc-tabs data-vc-target="[data-model-id='+s+']" data-vc-container=".vc_tta">'+n+"</a></li>"),!0!==a&&-1<(e=_.pluck(_.sortBy(vc.shortcodes.where({parent_id:this.model.get("id")}),function(t){return t.get("order")}),"id").indexOf(t.get("id"))-1)&&o.find("[data-vc-tab]:eq("+e+")").length&&(i.insertAfter(o.find("[data-vc-tab]:eq("+e+")")),d=!0),d||i.appendTo(o),t.get("isActiveSection")&&i.addClass(this.activeClass)),this.buildPagination()},getNextTab:function(t){var a=this.$el.find(".vc_tta-tabs-container .vc_tta-tabs-list").children(),e=a.length-1,i=t.index(),n=i!==e?a.eq(i+1):a.eq(i-1);return n},removeSection:function(t){var a,e=this.$el.find('.vc_tta-tabs-container .vc_tta-tabs-list [data-vc-target="[data-model-id='+t+']"]').parent();e.hasClass(this.activeClass)&&(a=this.getNextTab(e),vc.frame_window.jQuery(a).find("[data-vc-target]").trigger("click")),e.remove(),this.buildPagination()},buildSortableNavigation:function(){vc_user_access().shortcodeEdit(this.model.get("shortcode"))&&this.$el.find(".vc_tta-tabs-container .vc_tta-tabs-list").sortable({items:".vc_tta-tab",forcePlaceholderSize:!0,placeholder:"vc_tta-tab vc_placeholder-tta-tab",helper:this.renderSortingHelper,start:function(t,a){a.placeholder.width(a.item.width())},over:function(t,a){a.placeholder.css({maxWidth:a.placeholder.parent().width()}),a.placeholder.removeClass("vc_hidden-placeholder")},update:this.updateSortingNavigation})},updateSorting:function(t,a){window.InlineShortcodeView_vc_tta_tabs.__super__.updateSorting.call(this,t,a),this.updateTabsPositions(this.getPanelsList())},updateSortingNavigation:function(){var e=this,t=this.$el.find(".vc_tta-tabs-list");t.find("> .vc_tta-tab").each(function(){var t=l(this).removeAttr("style"),a=t.data("vcTargetModelId");vc.shortcodes.get(a).save({order:e.getIndex(t)},{silent:!0})}),this.updatePanelsPositions(t)},updateTabsPositions:function(t){var a,e,i=this.$el.find(".vc_tta-tabs-list");i.length&&(a=[],e=t.sortable("toArray",{attribute:"data-model-id"}),_.each(e,function(t){a.push(i.find('[data-vc-target-model-id="'+t+'"]'))},this),i.prepend(a)),this.buildPagination()},updatePanelsPositions:function(t){var a=this.getPanelsList(),e=[],i=t.sortable("toArray",{attribute:"data-vc-target-model-id"});_.each(i,function(t){e.push(a.find('[data-model-id="'+t+'"]'))},this),a.prepend(e),this.buildPagination()},renderSortingHelper:function(t,a){var e=a,i=a.width()+1,n=a.height();return e.width(i),e.height(n),e},buildPagination:function(){var t;this.removePagination(),t=this.model.get("params"),!_.isUndefined(t.pagination_style)&&t.pagination_style.length&&("top"===t.tab_position?this.$el.find(".vc_tta-panels-container").append(this.getPaginationList()):this.getPaginationList().insertBefore(this.$el.find(".vc_tta-container .vc_tta-panels")))}})}(window.jQuery);