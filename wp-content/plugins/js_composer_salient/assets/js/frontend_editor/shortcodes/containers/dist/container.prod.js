"use strict";!function(h){window.vc.events.on("shortcodeView:updated",function(e){var t;!0===(vc.map[e.get("shortcode")]||!1).is_container&&(t=e.get("id"),window.vc.frame_window.vc_iframe.updateChildGrids(t))}),window.InlineShortcodeViewContainer=window.InlineShortcodeView.extend({controls_selector:"#vc_controls-template-container",events:{"click > .vc_controls .vc_element .vc_control-btn-delete":"destroy","click > .vc_controls .vc_element .vc_control-btn-edit":"edit","click > .vc_controls .vc_element .vc_control-btn-clone":"clone","click > .vc_controls .vc_element .vc_control-btn-prepend":"prependElement","click > .vc_controls .vc_control-btn-append":"appendElement","click > .vc_empty-element":"appendElement",mouseenter:"resetActive",mouseleave:"holdActive"},hold_active:!1,parent_view:!1,initialize:function(e){_.bindAll(this,"holdActive"),window.InlineShortcodeViewContainer.__super__.initialize.call(this,e),this.model.get("parent_id")&&(this.parent_view=vc.shortcodes.get(this.model.get("parent_id")).view)},resetActive:function(){this.hold_active&&window.clearTimeout(this.hold_active)},holdActive:function(){this.resetActive(),this.$el.addClass("vc_hold-active");var e=this;this.hold_active=window.setTimeout(function(){e.hold_active&&window.clearTimeout(e.hold_active),e.hold_active=!1,e.$el.removeClass("vc_hold-active")},700)},content:function(){return!1===this.$content&&(this.$content=this.$el.find(".vc_container-anchor:first").parent(),this.$el.find(".vc_container-anchor:first").remove()),this.$content},render:function(){return window.InlineShortcodeViewContainer.__super__.render.call(this),this.content().addClass("vc_element-container"),this.$el.addClass("vc_container-block"),this},changed:function(){this.allowAddControlOnEmpty()&&(0===this.$el.find(".vc_element[data-tag]").length?this.$el.addClass("vc_empty").find("> :first").addClass("vc_empty-element"):this.$el.removeClass("vc_empty").find("> .vc_empty-element").removeClass("vc_empty-element"))},prependElement:function(e){e&&e.preventDefault&&e.preventDefault(),this.prepend=!0,window.vc.add_element_block_view.render(this.model,!0)},appendElement:function(e){e&&e.preventDefault&&e.preventDefault(),window.vc.add_element_block_view.render(this.model)},addControls:function(){var e,t,n,c,o,i,s,l,d=this.model.get("shortcode"),r=h(this.controls_selector).html(),a=vc.shortcodes.get(this.model.get("parent_id"));a&&(l=vc.getMapped(a.get("shortcode")).name,e=a.get("shortcode")),t=vc_user_access().shortcodeAll(d),c=vc_user_access().shortcodeEdit(d),o=vc_user_access().shortcodeAll(e),i=vc_user_access().shortcodeEdit(e),n=vc_user_access().partAccess("dragndrop"),s={name:vc.getMapped(d).name,tag:d,parent_name:l,parent_tag:e,can_edit:c,can_all:t,moveAccess:n,parent_can_edit:i,parent_can_all:o,state:vc_user_access().getState("shortcodes"),allowAdd:this.allowAddControl(),switcherPrefix:o&&t?"":"-disable-switcher"};var v=vc.template(_.unescape(r),_.extend({},vc.templateOptions.custom,{evaluate:/\{#([\s\S]+?)#}/g}));this.$controls=h(v(s).trim()).addClass("vc_controls"),this.$controls.appendTo(this.$el)},allowAddControl:function(){return"edit"!==vc_user_access().getState("shortcodes")},multi_edit:function(e){var t,n,c=[];e&&e.preventDefault&&e.preventDefault(),this.model.get("parent_id")&&(t=vc.shortcodes.get(this.model.get("parent_id"))),t?(c.push(t),n=vc.shortcodes.where({parent_id:t.get("id")}),window.vc.multi_edit_element_block_view.render(c.concat(n),this.model.get("id"))):window.vc.edit_element_block_view.render(this.model)},allowAddControlOnEmpty:function(){return"edit"!==vc_user_access().getState("shortcodes")}})}(window.jQuery);