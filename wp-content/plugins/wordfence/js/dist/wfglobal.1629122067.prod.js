"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(i){var t;window.wordfenceExt||(window.wordfenceExt={nonce:!1,loadingCount:0,isSmallScreen:!1,init:function(){this.nonce=WordfenceAdminVars.firstNonce,this.isSmallScreen=window.matchMedia("only screen and (max-width: 500px)").matches},showLoading:function(){this.loadingCount++,1==this.loadingCount&&jQuery('<div id="wordfenceWorking">'+t("Wordfence is working...")+"</div>").appendTo("body")},removeLoading:function(){this.loadingCount--,0==this.loadingCount&&jQuery("#wordfenceWorking").remove()},autoUpdateChoice:function(t){this.ajax("wordfence_autoUpdateChoice",{choice:t},function(t){jQuery("#wordfenceAutoUpdateChoice").fadeOut()},function(){jQuery("#wordfenceAutoUpdateChoice").fadeOut()})},misconfiguredHowGetIPsChoice:function(t){this.ajax("wordfence_misconfiguredHowGetIPsChoice",{choice:t},function(t){jQuery("#wordfenceMisconfiguredHowGetIPsNotice").fadeOut()},function(){jQuery("#wordfenceMisconfiguredHowGetIPsNotice").fadeOut()})},switchLiveTrafficSecurityOnlyChoice:function(t){this.ajax("wordfence_switchLiveTrafficSecurityOnlyChoice",{choice:t},function(t){jQuery("#switchLiveTrafficSecurityOnlyChoice").fadeOut()},function(){jQuery("#switchLiveTrafficSecurityOnlyChoice").fadeOut()})},dismissAdminNotice:function(e){this.ajax("wordfence_dismissAdminNotice",{id:e},function(t){jQuery('.wf-admin-notice[data-notice-id="'+e+'"]').fadeOut()},function(){jQuery('.wf-admin-notice[data-notice-id="'+e+'"]').fadeOut()})},hideNoticeForUser:function(e){this.ajax("wordfence_hideNoticeForUser",{id:e},function(t){i("#"+e).fadeOut()},function(){})},setOption:function(t,e,i){var n={};n[t]=e,this.ajax("wordfence_saveOptions",{changes:JSON.stringify(n)},function(t){t.success&&"function"==typeof i&&i(t)})},ajax:function(t,e,i,n,o){"string"==typeof e?(0<e.length&&(e+="&"),e+="action="+t+"&nonce="+this.nonce):"object"==_typeof(e)&&(e.action=t,e.nonce=this.nonce),n=n||function(){};var r=this;o||this.showLoading(),jQuery.ajax({type:"POST",url:WordfenceAdminVars.ajaxURL,dataType:"json",data:e,success:function(t){o||r.removeLoading(),t&&t.nonce&&(r.nonce=t.nonce),i(t)},error:function(){o||r.removeLoading(),n()}})},hashSHA256:function(t){return sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(t))},isEmailBlacklisted:function(t){for(var e=this.hashSHA256(t),i=0;i<WordfenceAdminVars.alertEmailBlacklist.length;i++)if(e===WordfenceAdminVars.alertEmailBlacklist[i])return!0;return!1},parseEmails:function(t){var e=[];if("string"!=typeof t)return e;for(var i=t.replace(/\s/g,"").split(","),n=0;n<i.length;n++){var o=i[n].toLowerCase();/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(i[n])&&!this.isEmailBlacklisted(o)&&e.push(o)}return e},onboardingProcessEmails:function(t,e,i){e=!!e;wordfenceExt.setOption("alertEmails",t.join(", ")),i&&this.ajax("wordfence_recordTOUPP",{},function(t){}),e&&this.ajax("wordfence_mailingSignup",{emails:JSON.stringify(t)},function(t){})},onboardingInstallLicense:function(t,e,i){this.ajax("wordfence_installLicense",{license:t},function(t){t.success?"function"==typeof e&&e(t):t.error&&"function"==typeof i&&i(t)})}}),t=window.wfi18n.__,window.wfi18n.sprintf,i(function(){wordfenceExt.init()})}(jQuery);var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};!function(b){b.cipher.aes=function(t){this.s[0][0][0]||this.T();var e,i,n,o=this.s[0][4],r=this.s[1],a=t.length,c=1;if(4!==a&&6!==a&&8!==a)throw new b.exception.invalid("invalid aes key size");for(this.b=[i=t.slice(0),n=[]],t=a;t<4*a+28;t++)e=i[t-1],(0==t%a||8===a&&4==t%a)&&(e=o[e>>>24]<<24^o[e>>16&255]<<16^o[e>>8&255]<<8^o[255&e],0==t%a&&(e=e<<8^e>>>24^c<<24,c=c<<1^283*(c>>7))),i[t]=i[t-a]^e;for(a=0;t;a++,t--)e=i[3&a?t:t-4],n[a]=t<=4||a<4?e:r[0][o[e>>>24]]^r[1][o[e>>16&255]]^r[2][o[e>>8&255]]^r[3][o[255&e]]},b.cipher.aes.prototype={encrypt:function(t){return this.$(t,0)},decrypt:function(t){return this.$(t,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],T:function(){for(var t,e,i,n,o,r,a=this.s[0],c=this.s[1],s=a[4],h=c[4],f=[],d=[],u=0;u<256;u++)d[(f[u]=u<<1^283*(u>>7))^u]=u;for(t=e=0;!s[t];t^=i||1,e=d[e]||1)for(o=(o=e^e<<1^e<<2^e<<3^e<<4)>>8^255&o^99,r=16843009*(n=f[u=f[i=f[h[s[t]=o]=t]]])^65537*u^257*i^16843008*t,n=257*f[o]^16843008*o,u=0;u<4;u++)a[u][t]=n=n<<24^n>>>8,c[u][o]=r=r<<24^r>>>8;for(u=0;u<5;u++)a[u]=a[u].slice(0),c[u]=c[u].slice(0)},$:function(t,e){if(4!==t.length)throw new b.exception.invalid("invalid aes block size");for(var i,n,o=this.b[e],r=t[0]^o[0],a=t[e?3:1]^o[1],c=t[2]^o[2],s=t[e?1:3]^o[3],h=o.length/4-2,f=4,d=[0,0,0,0],u=this.s[e],l=u[0],p=u[1],m=u[2],y=u[3],g=u[4],w=0;w<h;w++)u=l[r>>>24]^p[a>>16&255]^m[c>>8&255]^y[255&s]^o[f],i=l[a>>>24]^p[c>>16&255]^m[s>>8&255]^y[255&r]^o[f+1],n=l[c>>>24]^p[s>>16&255]^m[r>>8&255]^y[255&a]^o[f+2],s=l[s>>>24]^p[r>>16&255]^m[a>>8&255]^y[255&c]^o[f+3],f+=4,r=u,a=i,c=n;for(w=0;w<4;w++)d[e?3&-w:w]=g[r>>>24]<<24^g[a>>16&255]<<16^g[c>>8&255]<<8^g[255&s]^o[f++],u=r,r=a,a=c,c=s,s=u;return d}},b.bitArray={bitSlice:function(t,e,i){return t=b.bitArray.ga(t.slice(e/32),32-(31&e)).slice(1),void 0===i?t:b.bitArray.clamp(t,i-e)},extract:function(t,e,i){var n=Math.floor(-e-i&31);return(-32&(e+i-1^e)?t[e/32|0]<<32-n^t[e/32+1|0]>>>n:t[e/32|0]>>>n)&(1<<i)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var i=t[t.length-1],n=b.bitArray.getPartial(i);return 32===n?t.concat(e):b.bitArray.ga(e,n,0|i,t.slice(0,t.length-1))},bitLength:function(t){var e=t.length;return 0===e?0:32*(e-1)+b.bitArray.getPartial(t[e-1])},clamp:function(t,e){if(32*t.length<e)return t;var i=(t=t.slice(0,Math.ceil(e/32))).length;return e&=31,0<i&&e&&(t[i-1]=b.bitArray.partial(e,t[i-1]&2147483648>>e-1,1)),t},partial:function(t,e,i){return 32===t?e:(i?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(b.bitArray.bitLength(t)!==b.bitArray.bitLength(e))return!1;for(var i=0,n=0;n<t.length;n++)i|=t[n]^e[n];return 0===i},ga:function(t,e,i,n){var o=0;for(void 0===n&&(n=[]);32<=e;e-=32)n.push(i),i=0;if(0===e)return n.concat(t);for(o=0;o<t.length;o++)n.push(i|t[o]>>>e),i=t[o]<<32-e;return o=t.length?t[t.length-1]:0,t=b.bitArray.getPartial(o),n.push(b.bitArray.partial(e+t&31,32<e+t?i:n.pop(),1)),n},i:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]},byteswapM:function(t){for(var e,i=0;i<t.length;++i)e=t[i],t[i]=e>>>24|e>>>8&65280|(65280&e)<<8|e<<24;return t}},b.codec.utf8String={fromBits:function(t){for(var e,i="",n=b.bitArray.bitLength(t),o=0;o<n/8;o++)0==(3&o)&&(e=t[o/4]),i+=String.fromCharCode(e>>>8>>>8>>>8),e<<=8;return decodeURIComponent(escape(i))},toBits:function(t){t=unescape(encodeURIComponent(t));for(var e=[],i=0,n=0;n<t.length;n++)i=i<<8|t.charCodeAt(n),3==(3&n)&&(e.push(i),i=0);return 3&n&&e.push(b.bitArray.partial(8*(3&n),i)),e}},b.codec.hex={fromBits:function(t){for(var e="",i=0;i<t.length;i++)e+=(0xf00000000000+(0|t[i])).toString(16).substr(4);return e.substr(0,b.bitArray.bitLength(t)/4)},toBits:function(t){var e,i=[],n=(t=t.replace(/\s|0x/g,"")).length;for(t+="00000000",e=0;e<t.length;e+=8)i.push(0^parseInt(t.substr(e,8),16));return b.bitArray.clamp(i,4*n)}},b.codec.base32={D:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",da:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(t,e,i){var n=b.codec.base32.BASE,o=b.codec.base32.REMAINING,r="",a=0,c=b.codec.base32.D,s=0,h=b.bitArray.bitLength(t);for(i&&(c=b.codec.base32.da),i=0;r.length*n<h;)r+=c.charAt((s^t[i]>>>a)>>>o),a<n?(s=t[i]<<n-a,a+=o,i++):(s<<=n,a-=n);for(;7&r.length&&!e;)r+="=";return r},toBits:function(t,e){t=t.replace(/\s|=/g,"").toUpperCase();var i,n,o=b.codec.base32.BITS,r=b.codec.base32.BASE,a=b.codec.base32.REMAINING,c=[],s=0,h=b.codec.base32.D,f=0,d="base32";for(e&&(h=b.codec.base32.da,d="base32hex"),i=0;i<t.length;i++){if((n=h.indexOf(t.charAt(i)))<0){if(!e)try{return b.codec.base32hex.toBits(t)}catch(t){}throw new b.exception.invalid("this isn't "+d+"!")}a<s?(s-=a,c.push(f^n>>>s),f=n<<o-s):f^=n<<o-(s+=r)}return 56&s&&c.push(b.bitArray.partial(56&s,f,1)),c}},b.codec.base32hex={fromBits:function(t,e){return b.codec.base32.fromBits(t,e,1)},toBits:function(t){return b.codec.base32.toBits(t,1)}},b.codec.base64={D:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,i){var n="",o=0,r=b.codec.base64.D,a=0,c=b.bitArray.bitLength(t);for(i&&(r=r.substr(0,62)+"-_"),i=0;6*n.length<c;)n+=r.charAt((a^t[i]>>>o)>>>26),o<6?(a=t[i]<<6-o,o+=26,i++):(a<<=6,o-=6);for(;3&n.length&&!e;)n+="=";return n},toBits:function(t,e){t=t.replace(/\s|=/g,"");var i,n,o=[],r=0,a=b.codec.base64.D,c=0;for(e&&(a=a.substr(0,62)+"-_"),i=0;i<t.length;i++){if((n=a.indexOf(t.charAt(i)))<0)throw new b.exception.invalid("this isn't base64!");26<r?(r-=26,o.push(c^n>>>r),c=n<<32-r):c^=n<<32-(r+=6)}return 56&r&&o.push(b.bitArray.partial(56&r,c,1)),o}},b.codec.base64url={fromBits:function(t){return b.codec.base64.fromBits(t,1,1)},toBits:function(t){return b.codec.base64.toBits(t,1)}},b.hash.sha256=function(t){this.b[0]||this.T(),t?(this.H=t.H.slice(0),this.C=t.C.slice(0),this.l=t.l):this.reset()},b.hash.sha256.hash=function(t){return(new b.hash.sha256).update(t).finalize()},b.hash.sha256.prototype={blockSize:512,reset:function(){return this.H=this.ea.slice(0),this.C=[],this.l=0,this},update:function(t){"string"==typeof t&&(t=b.codec.utf8String.toBits(t));var e=this.C=b.bitArray.concat(this.C,t);if(o=this.l,9007199254740991<(t=this.l=o+b.bitArray.bitLength(t)))throw new b.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){for(var i=new Uint32Array(e),n=0,o=512+o-(512+o&511);o<=t;o+=512)this.M(i.subarray(16*n,16*(n+1))),n+=1;e.splice(0,16*n)}else for(o=512+o-(512+o&511);o<=t;o+=512)this.M(e.splice(0,16));return this},finalize:function(){for(var t=this.C,e=this.H,i=(t=b.bitArray.concat(t,[b.bitArray.partial(1,1)])).length+2;15&i;i++)t.push(0);for(t.push(Math.floor(this.l/4294967296)),t.push(0|this.l);t.length;)this.M(t.splice(0,16));return this.reset(),e},ea:[],b:[],T:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}for(var e,i,n=0,o=2;n<64;o++){for(i=!0,e=2;e*e<=o;e++)if(0==o%e){i=!1;break}i&&(n<8&&(this.ea[n]=t(Math.pow(o,.5))),this.b[n]=t(Math.pow(o,1/3)),n++)}},M:function(t){for(var e,i,n=this.H,o=this.b,r=n[0],a=n[1],c=n[2],s=n[3],h=n[4],f=n[5],d=n[6],u=n[7],l=0;l<64;l++)e=(e=l<16?t[l]:(e=t[l+1&15],i=t[l+14&15],t[15&l]=(e>>>7^e>>>18^e>>>3^e<<25^e<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+t[15&l]+t[l+9&15]|0))+u+(h>>>6^h>>>11^h>>>25^h<<26^h<<21^h<<7)+(d^h&(f^d))+o[l],u=d,d=f,f=h,h=s+e|0,s=c,c=a,r=e+((a=r)&c^s&(a^c))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;n[0]=n[0]+r|0,n[1]=n[1]+a|0,n[2]=n[2]+c|0,n[3]=n[3]+s|0,n[4]=n[4]+h|0,n[5]=n[5]+f|0,n[6]=n[6]+d|0,n[7]=n[7]+u|0}},b.mode.ccm={name:"ccm",I:[],listenProgress:function(t){b.mode.ccm.I.push(t)},unListenProgress:function(t){-1<(t=b.mode.ccm.I.indexOf(t))&&b.mode.ccm.I.splice(t,1)},ma:function(t){for(var e=b.mode.ccm.I.slice(),i=0;i<e.length;i+=1)e[i](t)},encrypt:function(t,e,i,n,o){var r,a=e.slice(0),c=b.bitArray,s=c.bitLength(i)/8,h=c.bitLength(a)/8;if(o=o||64,n=n||[],s<7)throw new b.exception.invalid("ccm: iv must be at least 7 bytes");for(r=2;r<4&&h>>>8*r;r++);return r<15-s&&(r=15-s),i=c.clamp(i,8*(15-r)),e=b.mode.ccm.Z(t,e,i,n,o,r),a=b.mode.ccm.F(t,a,i,e,o,r),c.concat(a.data,a.tag)},decrypt:function(t,e,i,n,o){o=o||64,n=n||[];var r=b.bitArray,a=r.bitLength(i)/8,c=r.bitLength(e),s=r.clamp(e,c-o),h=r.bitSlice(e,c-o),c=(c-o)/8;if(a<7)throw new b.exception.invalid("ccm: iv must be at least 7 bytes");for(e=2;e<4&&c>>>8*e;e++);if(e<15-a&&(e=15-a),i=r.clamp(i,8*(15-e)),s=b.mode.ccm.F(t,s,i,h,o,e),t=b.mode.ccm.Z(t,s.data,i,n,o,e),!r.equal(s.tag,t))throw new b.exception.corrupt("ccm: tag doesn't match");return s.data},ua:function(t,e,i,n,o,r){var a=[],c=b.bitArray,s=c.i;if(n=[c.partial(8,(e.length?64:0)|n-2<<2|r-1)],(n=c.concat(n,i))[3]|=o,n=t.encrypt(n),e.length)for((i=c.bitLength(e)/8)<=65279?a=[c.partial(16,i)]:i<=4294967295&&(a=c.concat([c.partial(16,65534)],[i])),a=c.concat(a,e),e=0;e<a.length;e+=4)n=t.encrypt(s(n,a.slice(e,e+4).concat([0,0,0])));return n},Z:function(t,e,i,n,o,r){var a=b.bitArray,c=a.i;if((o/=8)%2||o<4||16<o)throw new b.exception.invalid("ccm: invalid tag length");if(4294967295<n.length||4294967295<e.length)throw new b.exception.bug("ccm: can't deal with 4GiB or more data");for(i=b.mode.ccm.ua(t,n,i,o,a.bitLength(e)/8,r),n=0;n<e.length;n+=4)i=t.encrypt(c(i,e.slice(n,n+4).concat([0,0,0])));return a.clamp(i,8*o)},F:function(t,e,i,n,o,r){var a=b.bitArray,c=a.i,s=e.length,h=a.bitLength(e),f=s/50,d=f;if(i=a.concat([a.partial(8,r-1)],i).concat([0,0,0]).slice(0,4),n=a.bitSlice(c(n,t.encrypt(i)),0,o),!s)return{tag:n,data:[]};for(c=0;c<s;c+=4)f<c&&(b.mode.ccm.ma(c/s),f+=d),i[3]++,o=t.encrypt(i),e[c]^=o[0],e[c+1]^=o[1],e[c+2]^=o[2],e[c+3]^=o[3];return{tag:n,data:a.clamp(e,h)}}},b.mode.ocb2={name:"ocb2",encrypt:function(t,e,i,n,o,r){if(128!==b.bitArray.bitLength(i))throw new b.exception.invalid("ocb iv must be 128 bits");var a,c=b.mode.ocb2.W,s=b.bitArray,h=s.i,f=[0,0,0,0];i=c(t.encrypt(i));var d,u=[];for(n=n||[],o=o||64,a=0;a+4<e.length;a+=4)f=h(f,d=e.slice(a,a+4)),u=u.concat(h(i,t.encrypt(h(i,d)))),i=c(i);return d=e.slice(a),e=s.bitLength(d),a=t.encrypt(h(i,[0,0,0,e])),d=s.clamp(h(d.concat([0,0,0]),a),e),f=h(f,h(d.concat([0,0,0]),a)),f=t.encrypt(h(f,h(i,c(i)))),n.length&&(f=h(f,r?n:b.mode.ocb2.pmac(t,n))),u.concat(s.concat(d,s.clamp(f,o)))},decrypt:function(t,e,i,n,o,r){if(128!==b.bitArray.bitLength(i))throw new b.exception.invalid("ocb iv must be 128 bits");o=o||64;var a,c,s=b.mode.ocb2.W,h=b.bitArray,f=h.i,d=[0,0,0,0],u=s(t.encrypt(i)),l=b.bitArray.bitLength(e)-o,p=[];for(n=n||[],i=0;i+4<l/32;i+=4)a=f(u,t.decrypt(f(u,e.slice(i,i+4)))),d=f(d,a),p=p.concat(a),u=s(u);if(c=l-32*i,a=t.encrypt(f(u,[0,0,0,c])),a=f(a,h.clamp(e.slice(i),c).concat([0,0,0])),d=f(d,a),d=t.encrypt(f(d,f(u,s(u)))),n.length&&(d=f(d,r?n:b.mode.ocb2.pmac(t,n))),!h.equal(h.clamp(d,o),h.bitSlice(e,l)))throw new b.exception.corrupt("ocb: tag doesn't match");return p.concat(h.clamp(a,c))},pmac:function(t,e){for(var i=b.mode.ocb2.W,n=b.bitArray,o=n.i,r=[0,0,0,0],a=o(a=t.encrypt([0,0,0,0]),i(i(a))),c=0;c+4<e.length;c+=4)a=i(a),r=o(r,t.encrypt(o(a,e.slice(c,c+4))));return c=e.slice(c),n.bitLength(c)<128&&(a=o(a,i(a)),c=n.concat(c,[-2147483648,0,0,0])),r=o(r,c),t.encrypt(o(i(o(a,i(a))),r))},W:function(t){return[t[0]<<1^t[1]>>>31,t[1]<<1^t[2]>>>31,t[2]<<1^t[3]>>>31,t[3]<<1^135*(t[0]>>>31)]}},b.mode.gcm={name:"gcm",encrypt:function(t,e,i,n,o){var r=e.slice(0);return e=b.bitArray,n=n||[],t=b.mode.gcm.F(!0,t,r,n,i,o||128),e.concat(t.data,t.tag)},decrypt:function(t,e,i,n,o){var r=e.slice(0),a=b.bitArray,c=a.bitLength(r);if(n=n||[],r=(o=o||128)<=c?(e=a.bitSlice(r,c-o),a.bitSlice(r,0,c-o)):(e=r,[]),t=b.mode.gcm.F(!1,t,r,n,i,o),!a.equal(t.tag,e))throw new b.exception.corrupt("gcm: tag doesn't match");return t.data},ra:function(t,e){for(var i,n,o=b.bitArray.i,r=[0,0,0,0],a=e.slice(0),c=0;c<128;c++){for((i=0!=(t[Math.floor(c/32)]&1<<31-c%32))&&(r=o(r,a)),n=0!=(1&a[3]),i=3;0<i;i--)a[i]=a[i]>>>1|(1&a[i-1])<<31;a[0]>>>=1,n&&(a[0]^=-520093696)}return r},j:function(t,e,i){var n,o=i.length;for(e=e.slice(0),n=0;n<o;n+=4)e[0]^=4294967295&i[n],e[1]^=4294967295&i[n+1],e[2]^=4294967295&i[n+2],e[3]^=4294967295&i[n+3],e=b.mode.gcm.ra(e,t);return e},F:function(t,e,i,n,o,r){var a,c,s,h=b.bitArray,f=i.length,d=h.bitLength(i),u=h.bitLength(n),l=h.bitLength(o),p=e.encrypt([0,0,0,0]);for(o=96===l?(o=o.slice(0),h.concat(o,[1])):(o=b.mode.gcm.j(p,[0,0,0,0],o),b.mode.gcm.j(p,o,[0,0,Math.floor(l/4294967296),4294967295&l])),l=b.mode.gcm.j(p,[0,0,0,0],n),s=o.slice(0),n=l.slice(0),t||(n=b.mode.gcm.j(p,l,i)),c=0;c<f;c+=4)s[3]++,a=e.encrypt(s),i[c]^=a[0],i[c+1]^=a[1],i[c+2]^=a[2],i[c+3]^=a[3];return i=h.clamp(i,d),t&&(n=b.mode.gcm.j(p,l,i)),t=[Math.floor(u/4294967296),4294967295&u,Math.floor(d/4294967296),4294967295&d],n=b.mode.gcm.j(p,n,t),a=e.encrypt(o),n[0]^=a[0],n[1]^=a[1],n[2]^=a[2],n[3]^=a[3],{tag:h.bitSlice(n,0,r),data:i}}},b.misc.hmac=function(t,e){this.ca=e=e||b.hash.sha256;var i,n=[[],[]],o=e.prototype.blockSize/32;for(this.A=[new e,new e],t.length>o&&(t=e.hash(t)),i=0;i<o;i++)n[0][i]=909522486^t[i],n[1][i]=1549556828^t[i];this.A[0].update(n[0]),this.A[1].update(n[1]),this.V=new e(this.A[0])},b.misc.hmac.prototype.encrypt=b.misc.hmac.prototype.mac=function(t){if(this.ha)throw new b.exception.invalid("encrypt on already updated hmac called!");return this.update(t),this.digest(t)},b.misc.hmac.prototype.reset=function(){this.V=new this.ca(this.A[0]),this.ha=!1},b.misc.hmac.prototype.update=function(t){this.ha=!0,this.V.update(t)},b.misc.hmac.prototype.digest=function(){var t=this.V.finalize(),t=new this.ca(this.A[1]).update(t).finalize();return this.reset(),t},b.misc.pbkdf2=function(t,e,i,n,o){if(i=i||1e4,n<0||i<0)throw new b.exception.invalid("invalid params to pbkdf2");"string"==typeof t&&(t=b.codec.utf8String.toBits(t)),"string"==typeof e&&(e=b.codec.utf8String.toBits(e)),t=new(o=o||b.misc.hmac)(t);for(var r,a,c,s=[],h=b.bitArray,f=1;32*s.length<(n||1);f++){for(o=r=t.encrypt(h.concat(e,[f])),a=1;a<i;a++)for(r=t.encrypt(r),c=0;c<r.length;c++)o[c]^=r[c];s=s.concat(o)}return n&&(s=h.clamp(s,n)),s},b.prng=function(t){this.c=[new b.hash.sha256],this.m=[0],this.U=0,this.J={},this.R=0,this.Y={},this.fa=this.f=this.o=this.oa=0,this.b=[0,0,0,0,0,0,0,0],this.h=[0,0,0,0],this.O=void 0,this.P=t,this.G=!1,this.N={progress:{},seeded:{}},this.u=this.na=0,this.K=1,this.L=2,this.ja=65536,this.X=[0,48,64,96,128,192,256,384,512,768,1024],this.ka=3e4,this.ia=80},b.prng.prototype={randomWords:function(t,e){var i,n=[],o=this.isReady(e);if(o===this.u)throw new b.exception.notReady("generator isn't seeded");for(o&this.L&&this.ya(!(o&this.K)),o=0;o<t;o+=4)0==(o+1)%this.ja&&this.ba(),i=this.S(),n.push(i[0],i[1],i[2],i[3]);return this.ba(),n.slice(0,t)},setDefaultParanoia:function(t,e){if(0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e)throw new b.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.P=t},addEntropy:function(t,e,i){i=i||"user";var n,o=(new Date).valueOf(),r=this.J[i],a=this.isReady(),c=0,s=this.Y[i];switch(void 0===s&&(s=this.Y[i]=this.oa++),void 0===r&&(r=this.J[i]=0),this.J[i]=(this.J[i]+1)%this.c.length,_typeof(t)){case"number":void 0===e&&(e=1),this.c[r].update([s,this.R++,1,e,o,1,0|t]);break;case"object":if("[object Uint32Array]"===(i=Object.prototype.toString.call(t))){for(n=[],i=0;i<t.length;i++)n.push(t[i]);t=n}else for("[object Array]"!==i&&(c=1),i=0;i<t.length&&!c;i++)"number"!=typeof t[i]&&(c=1);if(!c){if(void 0===e)for(i=e=0;i<t.length;i++)for(n=t[i];0<n;)e++,n>>>=1;this.c[r].update([s,this.R++,2,e,o,t.length].concat(t))}break;case"string":void 0===e&&(e=t.length),this.c[r].update([s,this.R++,3,e,o,t.length]),this.c[r].update(t);break;default:c=1}if(c)throw new b.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[r]+=e,this.f+=e,a===this.u&&(this.isReady()!==this.u&&this.aa("seeded",Math.max(this.o,this.f)),this.aa("progress",this.getProgress()))},isReady:function(t){return t=this.X[void 0!==t?t:this.P],this.o&&this.o>=t?this.m[0]>this.ia&&(new Date).valueOf()>this.fa?this.L|this.K:this.K:this.f>=t?this.L|this.u:this.u},getProgress:function(t){return t=this.X[t||this.P],this.o>=t||this.f>t?1:this.f/t},startCollectors:function(){if(!this.G){if(this.a={loadTimeCollector:this.B(this.ta),mouseCollector:this.B(this.va),keyboardCollector:this.B(this.sa),accelerometerCollector:this.B(this.la),touchCollector:this.B(this.za)},window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else{if(!document.attachEvent)throw new b.exception.bug("can't attach event");document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)}this.G=!0}},stopCollectors:function(){this.G&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.G=!1)},addEventListener:function(t,e){this.N[t][this.na++]=e},removeEventListener:function(t,e){var i,n,o=this.N[t],r=[];for(n in o)o.hasOwnProperty(n)&&o[n]===e&&r.push(n);for(i=0;i<r.length;i++)delete o[n=r[i]]},B:function(t){var e=this;return function(){t.apply(e,arguments)}},S:function(){for(var t=0;t<4&&(this.h[t]=this.h[t]+1|0,!this.h[t]);t++);return this.O.encrypt(this.h)},ba:function(){this.b=this.S().concat(this.S()),this.O=new b.cipher.aes(this.b)},xa:function(t){for(this.b=b.hash.sha256.hash(this.b.concat(t)),this.O=new b.cipher.aes(this.b),t=0;t<4&&(this.h[t]=this.h[t]+1|0,!this.h[t]);t++);},ya:function(t){var e,i=[],n=0;for(this.fa=i[0]=(new Date).valueOf()+this.ka,e=0;e<16;e++)i.push(4294967296*Math.random()|0);for(e=0;e<this.c.length&&(i=i.concat(this.c[e].finalize()),n+=this.m[e],this.m[e]=0,t||!(this.U&1<<e));e++);this.U>=1<<this.c.length&&(this.c.push(new b.hash.sha256),this.m.push(0)),this.f-=n,n>this.o&&(this.o=n),this.U++,this.xa(i)},sa:function(){this.w(1)},va:function(t){var e,i;try{e=t.x||t.clientX||t.offsetX||0,i=t.y||t.clientY||t.offsetY||0}catch(t){i=e=0}0!=e&&0!=i&&this.addEntropy([e,i],2,"mouse"),this.w(0)},za:function(t){t=t.touches[0]||t.changedTouches[0],this.addEntropy([t.pageX||t.clientX,t.pageY||t.clientY],1,"touch"),this.w(0)},ta:function(){this.w(2)},w:function(t){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?this.addEntropy(window.performance.now(),t,"loadtime"):this.addEntropy((new Date).valueOf(),t,"loadtime")},la:function(t){var e;t=t.accelerationIncludingGravity.x||t.accelerationIncludingGravity.y||t.accelerationIncludingGravity.z,!window.orientation||"number"==typeof(e=window.orientation)&&this.addEntropy(e,1,"accelerometer"),t&&this.addEntropy(t,2,"accelerometer"),this.w(0)},aa:function(t,e){var i,n=b.random.N[t],o=[];for(i in n)n.hasOwnProperty(i)&&o.push(n[i]);for(i=0;i<o.length;i++)o[i](e)}},b.random=new b.prng(6),function(){try{var t,e,i,n,o;if(n="undefined"!=typeof module&&module.exports){try{o=require("crypto")}catch(t){o=null}n=e=o}if(n&&e.randomBytes)t=e.randomBytes(128),t=new Uint32Array(new Uint8Array(t).buffer),b.random.addEntropy(t,1024,"crypto['randomBytes']");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(i=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(i);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)return;window.msCrypto.getRandomValues(i)}b.random.addEntropy(i,1024,"crypto['getRandomValues']")}}catch(t){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(t))}}(),b.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},qa:function(t,e,i,n){i=i||{},n=n||{};var o,r=b.json,a=r.g({iv:b.random.randomWords(4,0)},r.defaults);if(r.g(a,i),i=a.adata,"string"==typeof a.salt&&(a.salt=b.codec.base64.toBits(a.salt)),"string"==typeof a.iv&&(a.iv=b.codec.base64.toBits(a.iv)),!b.mode[a.mode]||!b.cipher[a.cipher]||"string"==typeof t&&a.iter<=100||64!==a.ts&&96!==a.ts&&128!==a.ts||128!==a.ks&&192!==a.ks&&256!==a.ks||a.iv.length<2||4<a.iv.length)throw new b.exception.invalid("json encrypt: invalid parameters");return"string"==typeof t?(t=(o=b.misc.cachedPbkdf2(t,a)).key.slice(0,a.ks/32),a.salt=o.salt):b.ecc&&t instanceof b.ecc.elGamal.publicKey&&(o=t.kem(),a.kemtag=o.tag,t=o.key.slice(0,a.ks/32)),"string"==typeof e&&(e=b.codec.utf8String.toBits(e)),"string"==typeof i&&(a.adata=i=b.codec.utf8String.toBits(i)),o=new b.cipher[a.cipher](t),r.g(n,a),n.key=t,a.ct="ccm"===a.mode&&b.arrayBuffer&&b.arrayBuffer.ccm&&e instanceof ArrayBuffer?b.arrayBuffer.ccm.encrypt(o,e,a.iv,i,a.ts):b.mode[a.mode].encrypt(o,e,a.iv,i,a.ts),a},encrypt:function(t,e,i,n){var o=b.json,r=o.qa.apply(o,arguments);return o.encode(r)},pa:function(t,e,i,n){i=i||{},n=n||{};var o,r=b.json,a=(e=r.g(r.g(r.g({},r.defaults),e),i,!0)).adata;if("string"==typeof e.salt&&(e.salt=b.codec.base64.toBits(e.salt)),"string"==typeof e.iv&&(e.iv=b.codec.base64.toBits(e.iv)),!b.mode[e.mode]||!b.cipher[e.cipher]||"string"==typeof t&&e.iter<=100||64!==e.ts&&96!==e.ts&&128!==e.ts||128!==e.ks&&192!==e.ks&&256!==e.ks||!e.iv||e.iv.length<2||4<e.iv.length)throw new b.exception.invalid("json decrypt: invalid parameters");return"string"==typeof t?(t=(o=b.misc.cachedPbkdf2(t,e)).key.slice(0,e.ks/32),e.salt=o.salt):b.ecc&&t instanceof b.ecc.elGamal.secretKey&&(t=t.unkem(b.codec.base64.toBits(e.kemtag)).slice(0,e.ks/32)),"string"==typeof a&&(a=b.codec.utf8String.toBits(a)),o=new b.cipher[e.cipher](t),a="ccm"===e.mode&&b.arrayBuffer&&b.arrayBuffer.ccm&&e.ct instanceof ArrayBuffer?b.arrayBuffer.ccm.decrypt(o,e.ct,e.iv,e.tag,a,e.ts):b.mode[e.mode].decrypt(o,e.ct,e.iv,a,e.ts),r.g(n,e),n.key=t,1===i.raw?a:b.codec.utf8String.fromBits(a)},decrypt:function(t,e,i,n){var o=b.json;return o.pa(t,o.decode(e),i,n)},encode:function(t){var e,i="{",n="";for(e in t)if(t.hasOwnProperty(e)){if(!e.match(/^[a-z0-9]+$/i))throw new b.exception.invalid("json encode: invalid property name");switch(i+=n+'"'+e+'":',n=",",_typeof(t[e])){case"number":case"boolean":i+=t[e];break;case"string":i+='"'+escape(t[e])+'"';break;case"object":i+='"'+b.codec.base64.fromBits(t[e],0)+'"';break;default:throw new b.exception.bug("json encode: unsupported type")}}return i+"}"},decode:function(t){if(!(t=t.replace(/\s/g,"")).match(/^\{.*\}$/))throw new b.exception.invalid("json decode: this isn't json!");t=t.replace(/^\{|\}$/g,"").split(/,/);for(var e,i={},n=0;n<t.length;n++){if(!(e=t[n].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new b.exception.invalid("json decode: this isn't json!");null!=e[3]?i[e[2]]=parseInt(e[3],10):null!=e[4]?i[e[2]]=e[2].match(/^(ct|adata|salt|iv)$/)?b.codec.base64.toBits(e[4]):unescape(e[4]):null!=e[5]&&(i[e[2]]="true"===e[5])}return i},g:function(t,e,i){if(void 0===t&&(t={}),void 0===e)return t;for(var n in e)if(e.hasOwnProperty(n)){if(i&&void 0!==t[n]&&t[n]!==e[n])throw new b.exception.invalid("required parameter overridden");t[n]=e[n]}return t},Ba:function(t,e){var i,n={};for(i in t)t.hasOwnProperty(i)&&t[i]!==e[i]&&(n[i]=t[i]);return n},Aa:function(t,e){for(var i={},n=0;n<e.length;n++)void 0!==t[e[n]]&&(i[e[n]]=t[e[n]]);return i}},b.encrypt=b.json.encrypt,b.decrypt=b.json.decrypt,b.misc.wa={},b.misc.cachedPbkdf2=function(t,e){var i=b.misc.wa,n=(e=e||{}).iter||1e3;return(n=(i=i[t]=i[t]||{})[n]=i[n]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):b.random.randomWords(2,0)})[i=void 0===e.salt?n.firstSalt:e.salt]=n[i]||b.misc.pbkdf2(t,i,e.iter),{key:n[i].slice(0),salt:i.slice(0)}},"undefined"!=typeof module&&module.exports&&(module.exports=b),"function"==typeof define&&define([],function(){return b})}(sjcl);