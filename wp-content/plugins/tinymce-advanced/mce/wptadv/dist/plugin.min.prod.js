"use strict";!function(a){a.PluginManager.add("wptadv",function(i){var t=!i.settings.wpautop&&i.settings.tadv_noautop;function e(t){var e="table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary";return t=(t=(t=(t=(t=(t=t.replace(new RegExp("<(?:"+e+")(?: [^>]*)?>","gi"),"\n$&")).replace(new RegExp("</(?:"+e+")>","gi"),"$&\n")).replace(/(<br(?: [^>]*)?>)[\r\n\t]*/gi,"$1\n")).replace(/>\n[\r\n\t]+</g,">\n<")).replace(/^<li/gm,"\t<li")).replace(/<td>\u00a0<\/td>/g,"<td>&nbsp;</td>"),a.trim(t)}function n(t,e){var n=i.$(e);n.attr({width:null,height:null,minWidth:null,maxWidth:null,minHeight:null,maxHeight:null}),n.css({width:null,height:null}),n.is("table")&&n.css({"border-collapse":"collapse",width:"100%;"}),n.attr("style")?n.attr("data-mce-style",n.attr("style")):n.attr({style:null,"data-mce-style":null})}return i.addCommand("Tadv_Mark",function(){i.formatter.toggle("mark")}),i.addButton("tadv_mark",{icon:"backcolor",tooltip:"Mark",cmd:"Tadv_Mark",stateSelector:"mark"}),i.on("init",function(){t&&i.on("SaveContent",function(t){t.content=t.content.replace(/caption\](\s|<br[^>]*>|<p>&nbsp;<\/p>)*\[caption/g,"caption] [caption"),t.content=t.content.replace(/<(object|audio|video)[\s\S]+?<\/\1>/g,function(t){return t.replace(/[\r\n\t ]+/g," ")}),t.content=t.content.replace(/<pre( [^>]*)?>[\s\S]+?<\/pre>/g,function(t){return(t=t.replace(/<br ?\/?>(\r\n|\n)?/g,"\n")).replace(/<\/?p( [^>]*)?>(\r\n|\n)?/g,"\n")}),t.content=e(t.content)});try{i.plugins.searchreplace&&!i.controlManager.buttons.searchreplace&&i.shortcuts.remove("meta+f")}catch(t){}i.formatter.register({mark:{inline:"mark"}})}),i.on("ObjectResizeStart",function(t){var e,n,a,l=t.target,o=i.$(l);if(o.is("table")){if(l.style.width&&-1!==l.style.width.indexOf("%"))return;e=parseInt(o.parent().css("width"),10),n=parseInt(t.width,10),e&&n&&(Math.abs(e-n)<3?o.css({width:"100%"}):10<(a=Math.round(n/e*100))&&a<200&&o.css({width:a+"%"}))}},!0),i.addMenuItem("tmaresettablesize",{text:"Reset table size",cmd:"tmaResetTableSize",icon:"dashicon dashicons-image-flip-horizontal",context:"format"}),i.addMenuItem("tmaremovetablestyles",{text:"Remove table styling",cmd:"tmaRemoveTableStyles",icon:"dashicon dashicons-editor-table",context:"format"}),i.addButton("tmaresettablesize",{title:"Reset table size",cmd:"tmaResetTableSize",icon:"dashicon dashicons-image-flip-horizontal"}),i.addButton("tmaremovetablestyles",{title:"Remove table styling",cmd:"tmaRemoveTableStyles",icon:"dashicon dashicons-editor-table"}),i.addCommand("tmaRemoveTableStyles",function(){var t=i.selection.getStart(),e=i.dom.getParents(t,"table"),n={style:null,"data-mce-style":null,width:null,height:null,minWidth:null,maxWidth:null,minHeight:null,maxHeight:null,align:null,valign:null,axis:null,char:null,charoff:null,bgcolor:null,border:null,cellspacing:null,cellpadding:null};e&&i.$(e).attr(n).find("tr, th, td, thead, tbody, tfoot").each(function(t,e){i.$(e).attr(n)})}),i.addCommand("tmaResetTableSize",function(){var t=i.selection.getStart(),e=i.dom.getParents(t,"table");e&&(n(0,e),i.$(e).find("tr, th, td, thead, tbody, tfoot").each(n))}),t&&(i.on("beforeSetContent",function(t){var e,n=window.wp;n&&(e=(e=n.editor&&n.editor.autop)||n.oldEditor&&n.oldEditor.autop,t.load&&e&&t.content&&-1<t.content.indexOf("\n")&&!/<p>/i.test(t.content)&&(t.content=e(t.content)))},!0),i.settings.classic_block_editor&&i.on("beforeGetContent",function(t){var e;"raw"!==t.format&&(1===(e=a.$(".block-editor-block-list__block")).length&&"core/freeform"===e.attr("data-type")?i.$("p").each(function(t,e){e.hasAttributes()||i.$(e).attr("data-tadv-p","keep")}):i.$("p[data-tadv-p]").removeAttr("data-tadv-p"))},!0)),{addLineBreaks:e}})}(window.tinymce);