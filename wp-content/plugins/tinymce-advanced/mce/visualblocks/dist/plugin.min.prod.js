"use strict";!function(){function m(e,t,o){var n,s,l,i,c,a,u=e.dom,r=e.settings.visualblocks_content_css;l=e.getDoc(),i=r||t+"/css/visualblocks.css",a=g.toArray(l.getElementsByTagName("link")),0===g.grep(a,function(e){return e.id===f}).length&&(c=v.DOM.create("link",{id:f,rel:"stylesheet",href:i}),l.getElementsByTagName("head")[0].appendChild(c)),u.toggleClass(e.getBody(),"mce-visualblocks"),o.set(!o.get()),n=e,s=o.get(),n.fire("VisualBlocks",{state:s})}function d(o,n){return function(e){var t=e.control;t.active(n.get()),o.on("VisualBlocks",function(e){t.active(e.state)})}}var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),v=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),g=tinymce.util.Tools.resolve("tinymce.util.Tools"),f=v.DOM.uniqueId();e.add("visualblocks",function(e,t){var o,n,s,l,i,c,a,u,r=function e(t){function o(){return n}var n=t;return{get:o,set:function(e){n=e},clone:function(){return e(o())}}}(!1);a=t,u=r,(c=e).addCommand("mceVisualBlocks",function(){m(c,a,u)}),i=r,(l=e).addButton("visualblocks",{active:!1,title:"Show blocks",cmd:"mceVisualBlocks",onPostRender:d(l,i)}),l.addMenuItem("visualblocks",{text:"Show blocks",cmd:"mceVisualBlocks",onPostRender:d(l,i),selectable:!0,context:"view",prependToContext:!0}),n=t,s=r,(o=e).on("PreviewFormats AfterPreviewFormats",function(e){s.get()&&o.dom.toggleClass(o.getBody(),"mce-visualblocks","afterpreviewformats"===e.type)}),o.on("init",function(){o.getParam("visualblocks_default_state",!1)&&m(o,n,s)}),o.on("remove",function(){o.dom.removeClass(o.getBody(),"mce-visualblocks")})})}();